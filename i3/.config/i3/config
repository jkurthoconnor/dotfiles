
##############################################################################
#                           I3 CONFIG FILE (V4)                              #
#              reference: https://i3wm.org/docs/userguide.html               #
##############################################################################




#                           LAUNCHING and MODES                               #
##############################################################################

# set the modifier key
set $mod Mod4

# `i3-sensible-terminal` checks $TERMINAL value
set $TERMINAL "/usr/local/bin/termite"

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# start dmenu program launcher
bindsym $mod+Shift+Return exec "dmenu_run -l 10 -nf '#fbf1c7' -sb '#076678' -sf '#fbf1c7'"

# MODE DEFINITIONS AND BINDINGS
set $i3-meta i3 Meta: reload [c]onfig [r]estart [l]ock [e]xit
bindsym $mod+i mode "$i3-meta"
mode "$i3-meta" {

    # reload the configuration file
    bindsym c reload, mode "default"
    # restart i3 in-place (preserves layout/session)
    bindsym r restart, mode "default"
    bindsym l exec i3lock --color "$drk-bg-color", mode "default"
    bindsym e exec "i3-nagbar -t warning -m 'Really? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'", mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $system System: [r]eboot [p]oweroff  ||  GPU: [i]ntel [n]vidia
bindsym $mod+Escape mode "$system"
mode "$system" {
    bindsym r exec systemctl reboot, mode "default"
    bindsym p exec systemctl poweroff, mode "default"

    # switches GPUs on Oryx Pro laptop
    bindsym i exec sudo system76-power graphics intel, mode "default"
    bindsym n exec sudo system76-power graphics nvidia, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $resize Resize Workspace
bindsym $mod+r mode "$resize"
mode "$resize" {
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt

        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        bindsym Return mode "default"
        bindsym Escape mode "default"
}



#                           WINDOW and WORKSPACE MANAGEMENT                  #
##############################################################################

# WINDOW SETTINGS and NAVIGATION

# toggle fullscreen mode for the focused window
bindsym $mod+f fullscreen toggle

# toggle tiling / floating mode for focused window
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# Use Mouse+$mod to drag floating windows
floating_modifier $mod

# toggle show/hide scratchpad
bindsym $mod+Shift+s scratchpad show

# kill focused window
bindsym $mod+Shift+q kill

# prevent focus from following mouse
focus_follows_mouse no

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# set container type to be created at next 
# split to hold current window & its sibling
# make future splits horizontal (splits side-by-side)
bindsym $mod+s split h
# make future splits vertical
bindsym $mod+v split v

# change existing container layout
bindsym $mod+t layout toggle split
bindsym $mod+w layout stacking
bindsym $mod+e layout tabbed


# MONITORS / WORKSPACES SETTINGS and NAVIGATION

# set workspace variables
# `xrandr --current` for current state; see `man xrandr`
set $monitorLeft HDMI-0
set $monitorRight DP-0
set $laptopScreen eDP-1

# set workspace variables
set $workspace1 "1.     "
set $workspace2 "2.     "
set $workspace3 "3. term"
set $workspace4 "4. code"
set $workspace5 "5. servers"
set $workspace6 "6. docs"
set $workspace7 "7. notes"
set $workspace8 "8. comm"
set $workspace9 "9. term"
set $workspace0 "10. misc"

# bind workspaces to monitors (1st output found receives binding)
workspace $workspace1 output $monitorLeft $laptopScreen
workspace $workspace2 output $monitorLeft $laptopScreen
workspace $workspace3 output $monitorLeft $laptopScreen
workspace $workspace4 output $monitorLeft $laptopScreen
workspace $workspace5 output $monitorLeft $laptopScreen
workspace $workspace6 output $monitorRight $laptopScreen
workspace $workspace7 output $monitorRight $laptopScreen
workspace $workspace8 output $monitorRight $laptopScreen
workspace $workspace9 output $monitorRight $laptopScreen
workspace $workspace0 output $monitorRight $laptopScreen

# assign clients to workspaces when app maps the window
# i.e. not executed whenever window properties change to criterion
assign [class="^Slack$"] $workspace8

# assign client to scratchpad
for_window [class="^keepassxc$"] move scratchpad

# float pop-ups and dialogues
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable

# float certain client instances
for_window [instance="wicd-client.py"] floating enable resize set 400 600 move position center
for_window [instance="^arandr"] floating enable
for_window [instance="^etcher-electron"] floating enable move position center
for_window [instance="^lxappearance"] floating enable
for_window [instance="^pa(man)|(vumeter)|(vucontrol)"] floating enable
for_window [instance="pavucontrol"] resize set 400 600 move position center
for_window [instance="^pcmanfm"] floating enable
for_window [instance="^qtconfig-qt4"] floating enable
for_window [instance="^teensy"] floating enable resize set 400 600 move position center

# switch to workspace
bindsym $mod+1 workspace $workspace1
bindsym $mod+2 workspace $workspace2
bindsym $mod+3 workspace $workspace3
bindsym $mod+4 workspace $workspace4
bindsym $mod+5 workspace $workspace5
bindsym $mod+6 workspace $workspace6
bindsym $mod+7 workspace $workspace7
bindsym $mod+8 workspace $workspace8
bindsym $mod+9 workspace $workspace9
bindsym $mod+0 workspace $workspace0

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $workspace1
bindsym $mod+Shift+2 move container to workspace $workspace2
bindsym $mod+Shift+3 move container to workspace $workspace3
bindsym $mod+Shift+4 move container to workspace $workspace4
bindsym $mod+Shift+5 move container to workspace $workspace5
bindsym $mod+Shift+6 move container to workspace $workspace6
bindsym $mod+Shift+7 move container to workspace $workspace7
bindsym $mod+Shift+8 move container to workspace $workspace8
bindsym $mod+Shift+9 move container to workspace $workspace9
bindsym $mod+Shift+0 move container to workspace $workspace0

# move focused workspace to next output / screen
bindsym $mod+Shift+n move workspace to output right


#                           AESTHETICS                                       #
##############################################################################

set $background "/usr/share/backgrounds/xgu472hf2_by_lariliikala.jpg"

# Font for window titles; also the bar unless bar block {} specifies alt font
font pango:DejaVu Sans Mono 12

# set color variables: gruvboxesque
# medium brown
set $lt-bg-color #504945

# dark brown-black
set $blk-bg-color #1d2021
set $drk-bg-color #3c3836
set $drk-txt-color #1d2021

# cream
set $lt-txt-color #fbf1c7

# red
# #fb4934 

# green
# #b8bb26

# yellow
# fabd2f

# orange
# #fe8019
set $status #d65d0e

# blue
# #83a598

# purple
set $indicator #d3869b

# cyan
set $urgent-bg-color #8ec07c

# teal
# #076678

# Configure, Style & Start i3bar(s)
bar {
        id bar-0
        output primary
        tray_output primary
        separator_symbol "  |  "
        status_command i3status
        tray_padding 3

        colors {
              background         $blk-bg-color
              statusline         $status
              separator          $status

#                                border        bkgrnd           text
              focused_workspace  $status       $blk-bg-color    $status
              active_workspace   $drk-bg-color $blk-bg-color    $status
              inactive_workspace $drk-bg-color $blk-bg-color    $status
              urgent_workspace   $drk-bg-color $urgent-bg-color $drk-txt-color
        }
}

bar {
        id bar-1
        output DP-0
        status_command i3status --config ~/.config/i3status/small_config
        tray_output none

        colors {
              background         $blk-bg-color
              statusline         $status
              separator          $status

#                                border        bkgrnd           text
              focused_workspace  $status       $blk-bg-color    $status
              active_workspace   $drk-bg-color $blk-bg-color    $status
              inactive_workspace $drk-bg-color $blk-bg-color    $status
              urgent_workspace   $drk-bg-color $urgent-bg-color $drk-txt-color
        }
}

# Widow Bar Colors
#                       border            background       txt            indicator
client.focused          $lt-bg-color      $lt-bg-color     $lt-txt-color  $indicator
client.focused_inactive $drk-bg-color     $drk-bg-color    $lt-txt-color  $indicator
client.unfocused        $drk-bg-color     $drk-bg-color    $lt-txt-color  $indicator
client.urgent           $urgent-bg-color  $urgent-bg-color $lt-txt-color  $indicator
client.placeholder      $lt-bg-color      $lt-bg-color     $lt-bg-color   $lt-bg-color



#                          STARTUP CALLS                                    #
##############################################################################

# start dropbox with icon in tray
exec_always --no-startup-id /usr/bin/dropbox start -i

# `feh` image viewer sets bkgrnd; see `man feh`
# exec_always feh --no-fehbg --bg-scale $background

# pulse audio controls in tray
exec --no-startup-id pasystray

# set xrandr settings by hostname
exec_always $HOME/.config/i3/scripts/i3_xrandr_screen_layout.sh

# load networking services by hostname
exec $HOME/.config/i3/scripts/i3_networking.sh

# load pre-defined workspaces by hostname
exec $HOME/.config/i3/scripts/i3_predefined_workspace_layouts.sh

# # vim:filetype=i3
